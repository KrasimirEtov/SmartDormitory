@*@model IEnumerable<SmartDormitory.Data.Models.Coordinates>*@

@{
    ViewData["Title"] = "Home Page";
}
<style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
    #map {
        height: 400px; /* The height is 400 pixels */
        width: 100%; /* The width is the width of the web page */
    }
</style>

<h1>Google maps magic</h1>


<div id="map"></div>

<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAbGBfxwfVNuXS1OY-O8qbuglmWIbkEC70&callback=initMap">
</script>
<script src="~/lib/markerclusterer/js/markerclusterer.js"></script>
<script defer >
    var map;
    // Initialize and add the map
    function initMap() {
        var sofiaCenterOfTheMap = { lat: 42.6977, lng: 23.3219 };

        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 11,
            center: sofiaCenterOfTheMap
        });
    }


    $(function () {
        let markers = [];
        $.getJSON("/Home/GetSensorsCoordinates", function (data) {
            for (var i = 0; i < data.length; i++) {

                //console.log(data[i].latitude)
                //console.log(data[i].longitude)

                var latLng = new google.maps.LatLng(data[i].latitude,
                    data[i].longitude);

                markers[i] = new google.maps.Marker({
                    position: latLng,
                    map: map
                });

                console.log(markers[i]);
            }
            //console.log(data)
        });

        //var markers = locations.map(function (location, i) {
        //    return new google.maps.Marker({
        //        position: location,
        //        label: labels[i % labels.length]
        //    });
        //});

        // Add a marker clusterer to manage the markers.
        //var markerCluster = new MarkerClusterer(map, markers,
        //    {
        //        imagePath: "~/lib/markerclusterer/img/"
        //    });

    });
</script>


